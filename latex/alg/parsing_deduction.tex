\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}
\renewcommand{\Comment}[2][.5\linewidth]{%
	\leavevmode\hfill\makebox[#1][l]{$\triangleright$~#2}}
	
\begin{algorithm}
	\caption{Weighted deductive parsing for PLCFRS}
	\label{alg:parse}
	\begin{algorithmic}[1]
		\Require PLCFRS $(G, p)$ with $G = (N, \Sigma, V, P, S)$,
		\Statex sentence $w = w_1 \ldots w_n$,
		\Statex pruning policy $\pi$
		\Ensure pruned derivation graph $H \in \mathcal{I}_{(G, p)}(w)$
		\Statex
		\Function{Parse}{$(G, p), w, \pi$}
			\State $V := \mathcal{P}([|w|]) \setminus \{\emptyset\}$
				\Comment{initialize set of vertices}
			\For{$v \in V$}
				\For{$A \in N$}
					\State $\omega(v, A) := undefined$
						\Comment{initialize the witness function}
				\EndFor
			\EndFor
			\State $Q := \{\}$
			\State Add each item generated by \textproc{Scan} to $Q$
			\State $E := \{\}$
				\Comment{initialize set of hyperedges}
			\For{$e \in Q$}
				\State $b(e) := 1$
				\State \textproc{Update}($\omega, \eta_e|_1, \eta_e|_2$)
			\EndFor
			\While{$Q \neq \emptyset$}
				\State $e := \argmax_{e' \in Q}
					(\wp_e \cdot \prod_{(u, B) \in \theta_e} \omega(u, B)|_2)$
				\State $Q := Q \setminus \{e\}$
				\State $E := E \cup \{e\}$
				\For{each $e'$ deduced from $e$ and other items in $E$ by \textproc{Rule}}
					\If{$\pi(e', w) = keep$}
						\State \textproc{Update}($\omega, \eta_{e'}|_1, \eta_{e'}|_2$)
						\State $b(e') := 1$
							\Comment{define mapping for $e'$}
						\If{$e' \notin E \cup Q$}
							\State $Q := Q \cup \{e'\}$
						\EndIf
					\EndIf
				\EndFor
			\EndWhile
			\State \Return $(V, E, b, \omega)$
		\EndFunction
		\Statex
		\Function{Update}{$\omega, v, A$}
			\For{$i \in In(v, A)$}
				\Comment{$i = (v_i, A_i)\langle \wp_i \rangle \to \theta_i$
					: hyperedge}
				\State $s := \wp_i \cdot b(i) \cdot
					\prod_{(u_i, B_i) \in \theta_i}\omega(u_i, B_i)_2$
				\If{$s > \omega(v_i, A_i)|_2$ or $\omega(v_i, A_i) = undefined$}
					\State $\omega(v_i, A_i) := (i, s)$
						\Comment{redefine mapping for $v_i$ and $A_i$}
				\EndIf
			\EndFor
		\EndFunction
	\end{algorithmic}
\end{algorithm}